
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Circle Of Fifth</title>
<script src="Snap.svg-0.4.1/dist/snap.svg-min.js"></script>
</head>
<body>
<script>

// Snap declaration
var s = Snap(800, 400);
var r = 80; // radius of the circle of fifth
var cx = 100; // center of the circle
var cy = 100;
var dotx, doty;
var dot;
var dots = [];
var chord;

// What is happening when you click on a dot
var dotClickCallback = function(event) {
    if(this.selected == false){
      this.select();
      console.log(this.selected);

    }else{
      this.deselect();
    };
};


// This function will draw the shape between all selected dots.
var drawChord = function(event) {

  var path = "";
  for(i in dots){
      if(dots[i].selected == true){
        if(path == "") path = path + " M "
        else  path = path + " L "
        path = path +  dots[i].node.cx.baseVal.value + " " + dots[i].node.cy.baseVal.value;
              console.log(dots[i].number);
      }

  }
  // remove precendent shape if necessary
  if( chord !== undefined) chord.remove();

  chord = s.path(path);
}

// Deselects all selected dots and removes the shape
var resetChord = function(event) {
  var path = "";
  for(i in dots){
      dots[i].deselect();
  }
  // remove precendent shape if necessary
  if( chord !== undefined) chord.remove();
}

// This circle will be our main circle of fifth
var circleFifth = s.circle(cx , cy , r);
circleFifth.attr({
  fill: "white",
  stroke: "blue",
  strokeWidth: 4
});

// This function will help us change from going around a circle of fifth to half steps
function fifthToHalfStep( note ){


}

a= 3 * Math.PI  / 2 ;
var halfToneAngle = 2 * Math.PI / 12 * 7; // 2pi is a full angle, divided by 12, times 7 in order to have a half tone
for( i = 0 ; i < 12 ; i++){



    // Construction of the circle
    dotx = Math.round(cx + (r * Math.cos(a)));
    doty = Math.round(cy + (r * Math.sin(a)));
    dot = s.circle(dotx, doty , 10);
    a = a + halfToneAngle;

    // Adding Select and deselect functions
    dot.deselect = function(){
      this.selected = false;
      this.attr({ fill: 'black' });
    }

    dot.select = function(){
      this.selected = true;
      this.attr({ fill: 'blue' });
    }

    // Adding Click Handler
    dot.click(dotClickCallback);
    dot.selected = false;
    dot.number = i;
    dots.push(dot);
}

var buttonDraw = s.rect(200, 200, 50, 50);
buttonDraw.click(drawChord);

var buttonReset = s.rect(200, 260, 50, 50);
buttonReset.click(resetChord);


function changeThird(third){
  if(third.value == "minor"){
    dots[3].select();

  }else{
    dots[4].select();
  }
}

</script>
<select name="third" onchange="changeThird(this)">
  <option value="minor">Minor Third</option>
  <option value="major" selected>Major Third</option>
</select>

<button onclick="resetChord()">Click me</button>

</body>
</html>
